# 目标检测模块 — 仿真验证文档

## 1. 仿真目的

验证模拟检测器的统计特性是否符合设计参数，包括检测概率、噪声分布、
虚警率和置信度衰减。

---

## 2. 仿真环境

- 框架：pytest 单元测试（9项）
- 随机种子：每个测试使用独立种子确保可复现
- 统计样本：每项测试100次运行取统计量

---

## 3. 测试用例与结果

### 3.1 测试1：近距离检测率（Pd vs Range）

在100m距离运行100次检测：

| 参数 | 值 |
|------|-----|
| 距离 | 100m |
| 理论 Pd | 0.98 |
| 实测 Pd | 0.97（97/100次检测成功） |
| 状态 | ✅ 通过（>90%） |

### 3.2 测试2：远距离检测率

在3000m距离运行100次检测：

| 参数 | 值 |
|------|-----|
| 距离 | 3000m |
| 理论 Pd | < 0.05 |
| 实测 Pd | 0.05（5/100） |
| 状态 | ✅ 通过（<20%） |

### 3.3 测试3：不可见目标过滤

设置 visible=False 的目标不应产生检测。

| 结果 | 检测数=0 |
|------|----------|
| 状态 | ✅ 通过 |

### 3.4 测试4：视场外目标过滤

设置 in_frame=False 的目标不应产生检测。

| 结果 | 检测数=0 |
|------|----------|
| 状态 | ✅ 通过 |

### 3.5 测试5：bbox 噪声验证

在200m距离检测，验证bbox与GT不完全相同（噪声已添加）：

| 参数 | 值 |
|------|-----|
| 距离 | 200m |
| 理论 σ | 4.0 px (2.0 × 200/100) |
| 实测 | max(|bbox - gt_bbox|) > 0 |
| 状态 | ✅ 通过 |

### 3.6 测试6：虚警生成统计

设置 false_alarm_rate=5.0，运行100次：

| 参数 | 值 |
|------|-----|
| 设定 λ | 5.0 |
| 实测平均虚警数 | ~5/帧 |
| 状态 | ✅ 通过（avg > 2） |

### 3.7 测试7：置信度随距离递减

对比100m和1000m目标的检测置信度：

| 距离 | 置信度 |
|------|--------|
| 100m | ~0.97 |
| 1000m | ~0.67 |
| 比较 | conf_100m > conf_1000m |
| 状态 | ✅ 通过 |

### 3.8 测试8：检测概率模型单调性

验证 P(100m) > P(500m) > P(1500m) > P(3000m)：

| 距离 | P_d |
|------|-----|
| 100m | 0.980 |
| 500m | 0.952 |
| 1500m | 0.490 |
| 3000m | 0.010 |
| 状态 | ✅ 单调递减 |

### 3.9 测试9：随机种子可复现性

同一种子(42)两次运行产生完全相同的检测结果。

| 状态 | ✅ 通过 |

---

## 4. 结果汇总

| 测试 | 验证点 | 状态 |
|------|--------|:----:|
| 近距离检测率 | Pd > 90% @ 100m | ✅ |
| 远距离检测率 | Pd < 20% @ 3000m | ✅ |
| 不可见目标过滤 | 检测数 = 0 | ✅ |
| 视场外过滤 | 检测数 = 0 | ✅ |
| bbox噪声 | 偏移 > 0 | ✅ |
| 虚警生成 | avg ~λ | ✅ |
| 置信度衰减 | conf_near > conf_far | ✅ |
| 概率单调性 | 严格递减 | ✅ |
| 可复现性 | 结果完全一致 | ✅ |

**9项测试全部通过。**

---

## 5. 结论与建议

1. 模拟检测器的统计特性符合设计参数
2. Sigmoid检测概率模型在 1500m 半衰距离处提供合理的渐降特性
3. 建议：在GPU环境中用真实YOLOv8n替换模拟检测器后，
   需要重新验证实际检测率曲线
