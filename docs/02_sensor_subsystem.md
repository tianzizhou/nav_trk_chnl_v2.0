# 传感器子系统详细设计

## 1 文档信息

| 项目 | 内容 |
|------|------|
| 文档编号 | CUAV-SNS-002 |
| 版本 | V1.0.0 |
| 日期 | 2026-02-20 |

---

## 2 概述

本文档详细描述多模态融合反无人机探测系统中四种传感器子系统的技术参数、
信号处理流程、输出数据格式以及各传感器的能力边界与互补关系。

### 2.1 传感器配置总览

系统配置四种异构传感器，形成 **主动+被动** 、 **测距+测角** 的互补体系：

| 传感器 | 类型 | 探测方式 | 量测维度 | 探测距离 | 核心优势 |
|--------|------|---------|---------|---------|---------|
| FMCW雷达 | 主动 | 电磁波 | R, Az, El, Vr | 3000 m | 全天候、测距测速 |
| 光电系统 | 被动 | 可见光/红外 | Az, El | 2500 m | 高角度精度、目标识别 |
| 声学阵列 | 被动 | 声波 | Az, El | 300 m | 检测悬停、不受杂波影响 |
| 无线电侦测 | 被动 | 电磁波 | Az | 1500 m | 识别通信协议、被动探测 |

### 2.2 传感器互补性分析

```
             距离(m)
             3000 ┤ ████████ 雷达
             2500 ┤ ████████
             2000 ┤ ████████ ▓▓▓▓▓▓ 光电
             1500 ┤ ████████ ▓▓▓▓▓▓ ░░░░ RF侦测
             1000 ┤ ████████ ▓▓▓▓▓▓ ░░░░
              500 ┤ ████████ ▓▓▓▓▓▓ ░░░░ ▒▒▒▒ 声学
              300 ┤ ████████ ▓▓▓▓▓▓ ░░░░ ▒▒▒▒
              100 ┤ ████████ ▓▓▓▓▓▓ ░░░░ ▒▒▒▒
                0 ┤─────────────────────────────
                  低空杂波  近距脱跟  蛙跳  城市
                        典型困难场景
```

各场景下传感器有效性矩阵：

| 场景 | 雷达 | 光电 | 声学 | RF侦测 |
|------|------|------|------|--------|
| 开阔/中高空 | ✅ 优 | ✅ 优 | ⚠️ 距离有限 | ✅ 良 |
| 超低空 (<10m) | ❌ 杂波淹没 | ✅ 良 | ✅ 优 | ✅ 良 |
| 近距 (<200m) | ✅ 良 | ⚠️ 窄视场脱跟 | ✅ 优 | ✅ 良 |
| 蛙跳悬停 | ⚠️ 多普勒失效 | ✅ 良 | ✅ 优（旋翼噪声） | ✅ 良 |
| 城市背景 | ⚠️ 多径/遮挡 | ⚠️ 遮挡 | ✅ 良（声波绕射） | ✅ 良 |
| 雨雾天气 | ✅ 良 | ❌ 衰减严重 | ✅ 良 | ✅ 良 |
| 自主飞行 | ✅ 良 | ✅ 良 | ✅ 良 | ❌ 无信号 |

---

## 3 FMCW 雷达子系统

### 3.1 系统参数

| 参数 | 指标 | 备注 |
|------|------|------|
| 工作频段 | X波段 (9.0 ~ 9.5 GHz) | λ ≈ 3.2 cm |
| 信号体制 | FMCW (调频连续波) | 线性调频 |
| 发射功率 | 1 W (峰值) | EIRP ≈ 30 dBm |
| 天线类型 | 有源相控阵 | 方位电扫+俯仰电扫 |
| 方位覆盖 | 360° (4面阵拼接或机扫) | 每面 90° |
| 俯仰覆盖 | 0° ~ 45° | 电子扫描 |
| 探测距离 | ≥ 3000 m (RCS=0.01 m²) | Pd ≥ 0.8, Pfa ≤ 1e-6 |
| 距离分辨率 | ≤ 1.5 m | B ≥ 100 MHz |
| 速度分辨率 | ≤ 0.5 m/s | CPI ≈ 60 ms |
| 方位分辨率 | ≤ 3° | 天线口径 ~30 cm |
| 俯仰分辨率 | ≤ 10° | |
| 数据刷新率 | ≥ 5 Hz | 200 ms/周期 |
| 功耗 | ≤ 200 W | |
| 重量 | ≤ 30 kg | |

### 3.2 FMCW 信号参数设计

**Chirp 参数**：

| 参数 | 值 | 计算依据 |
|------|-----|---------|
| 带宽 B | 150 MHz | 距离分辨率 = c/(2B) = 1.0 m |
| Chirp 周期 Tc | 100 μs | |
| 调频斜率 K | 1.5 × 10¹² Hz/s | K = B/Tc |
| 每帧 Chirp 数 | 512 | 速度分辨率 ≤ 0.5 m/s |
| 帧时间 | 51.2 ms | 512 × 100 μs |
| 采样率 | 10 MHz | 最大距离 ~5000 m |
| 每 Chirp 采样数 | 1024 | |

**最大不模糊距离**：

\[
R_{max} = \frac{f_s \cdot c}{2K} = \frac{10 \times 10^6 \times 3 \times 10^8}{2 \times 1.5 \times 10^{12}} \approx 1000 \text{ m (单 Chirp)}
\]

通过延迟解模糊扩展到 3000 m 以上。

**最大不模糊速度**：

\[
V_{max} = \frac{\lambda}{4 T_c} = \frac{0.032}{4 \times 100 \times 10^{-6}} = 80 \text{ m/s}
\]

满足 50 m/s 目标速度需求。

**速度分辨率**：

\[
\Delta V = \frac{\lambda}{2 N T_c} = \frac{0.032}{2 \times 512 \times 100 \times 10^{-6}} \approx 0.31 \text{ m/s}
\]

### 3.3 雷达信号处理流程

```
ADC采样 → 去直流 → 距离FFT → MTI对消 → 多普勒FFT
                                            ↓
                                     距离-多普勒图 (RD Map)
                                            ↓
                                    杂波图更新 + OS-CFAR
                                            ↓
                                     点迹提取 (R, Az, El, Vr)
                                            ↓
                                    微多普勒分析 (悬停检测)
                                            ↓
                                     输出点迹报告
```

#### 3.3.1 杂波抑制

**三脉冲对消 MTI**：

\[
y[n] = x[n] - 2x[n-1] + x[n-2]
\]

频率响应为：

\[
H(f) = 4 \sin^2(\pi f T_c)
\]

在零频（地杂波）处有深度零点，抑制度 > 40 dB。

**自适应杂波图**：

对每个距离-方位门（range-azimuth cell），维护杂波功率的滑动平均：

\[
C_{map}(r, \theta, k) = \alpha \cdot C_{map}(r, \theta, k-1) + (1 - \alpha) \cdot |y(r, \theta, k)|^2
\]

参数选择：
- 遗忘因子 α = 0.95（约 20 帧建立稳定杂波图）
- 杂波图更新率 = 5 Hz

检测时，将当前 RD Map 功率与杂波图门限对比：

\[
\text{检测判决}: |y(r, \theta, k)|^2 > C_{map}(r, \theta, k) \times T_{CM}
\]

其中 \(T_{CM}\) 为杂波图门限系数，典型值 3 ~ 6 dB。

#### 3.3.2 OS-CFAR 检测

在距离-多普勒平面上执行二维 OS-CFAR：

**参考窗参数**：
- 参考单元数 N = 32（左右各 16）
- 保护单元数 G = 4（左右各 2）
- 有序统计排位 k = 24（取第 3/4 分位数）

**门限计算**：

\[
T_{threshold} = T_{OS} \times X_{(k)}
\]

其中 \(X_{(k)}\) 为 N 个参考单元功率按升序排列后的第 k 个值。

\(T_{OS}\) 由 Pfa 需求反推：

\[
P_{fa} = \frac{k \binom{N}{k}}{T_{OS}} \cdot B\left(\frac{1}{1+T_{OS}}, k, N-k+1\right)
\]

对于 Pfa = 1e-6, N = 32, k = 24, 可数值求解得 \(T_{OS} \approx 4.5\)。

#### 3.3.3 微多普勒悬停检测

悬停无人机机体静止但旋翼旋转，产生微多普勒特征：

**旋翼微多普勒模型**：

单个旋翼叶片的微多普勒频移：

\[
f_{\mu D}(t) = \frac{2 \omega L}{\lambda} \cos(\omega t + \phi_0) \cos(\theta)
\]

其中：
- \(\omega\) 为旋翼角速度（典型 200 ~ 600 rad/s）
- \(L\) 为桨叶长度（典型 0.1 ~ 0.3 m）
- \(\theta\) 为雷达视线与旋翼平面的夹角
- \(\phi_0\) 为初始相位

**最大微多普勒频移**：

\[
f_{\mu D, max} = \frac{2 \omega L}{\lambda} = \frac{2 \times 400 \times 0.15}{0.032} \approx 3750 \text{ Hz}
\]

**STFT 提取微多普勒**：

\[
S(t, f) = \left| \int x(\tau) \cdot w(\tau - t) \cdot e^{-j 2\pi f \tau} \, d\tau \right|^2
\]

窗函数选择 Hamming 窗，窗长 10 ms（100 个 chirp），步进 2 ms。

**悬停判决**：
1. 检测 RD Map 中零多普勒附近 (|Vr| < 1 m/s) 的弱目标
2. 对候选目标执行 STFT 分析
3. 在时频图中搜索旋翼微多普勒调制线
4. 若检测到周期性微多普勒特征 → 判定为悬停无人机

### 3.4 雷达点迹输出格式

```
struct RadarPlot {
    uint32_t  timestamp_ms;    // GPS时间戳 (ms)
    float     range_m;         // 斜距 (m)
    float     azimuth_rad;     // 方位角 (rad), 正北为0
    float     elevation_rad;   // 俯仰角 (rad)
    float     radial_vel_mps;  // 径向速度 (m/s), 接近为负
    float     snr_dB;          // 信噪比 (dB)
    float     rcs_dBsm;       // RCS估计 (dBsm)
    uint8_t   hover_flag;      // 悬停检测标志 (0/1)
    uint8_t   clutter_flag;    // 杂波区标志 (0/1)
};
```

---

## 4 光电子系统

### 4.1 系统配置

光电系统采用 **"窄视场双光 + 广角"** 三通道配置，解决近距脱跟问题：

| 通道 | 传感器 | 焦距 | 视场角 | 分辨率 | 用途 |
|------|--------|------|--------|--------|------|
| 窄视场-可见光 | CMOS | 200 mm | 2.7° × 1.5° | 1920×1080 | 远距搜索/确认 |
| 窄视场-红外 | 非制冷VOx | 75 mm | 8.5° × 6.8° | 640×512 | 全天候/低能见度 |
| 广角-可见光 | CMOS | 6 mm | 60° × 45° | 1920×1080 | 近距跟踪 |

### 4.2 云台参数

| 参数 | 指标 |
|------|------|
| 方位范围 | 连续 360° |
| 俯仰范围 | -20° ~ +70° |
| 最大转速 | 120°/s |
| 跟踪精度 | ≤ 0.5 mrad (RMS) |
| 最大跟踪角速率 | 60°/s |
| 稳定精度 | ≤ 0.1 mrad (RMS) |

### 4.3 探测距离估算

**Johnson 准则**估算（对 0.3 m 尺寸目标）：

| 任务 | 所需线对数 | 窄视场-可见光 | 窄视场-红外 | 广角-可见光 |
|------|-----------|-------------|-----------|-----------|
| 发现 | 1.0 ± 0.25 | ~4000 m | ~2500 m | ~300 m |
| 确认 | 3.0 ± 0.8 | ~2000 m | ~1200 m | ~150 m |
| 识别 | 6.0 ± 1.5 | ~1000 m | ~600 m | ~80 m |

### 4.4 图像处理流程

```
┌─────────────────────────────────────────────────────────────┐
│                     光电图像处理流程                         │
│                                                             │
│  ┌──────────┐    ┌───────────┐    ┌───────────┐             │
│  │ 图像采集 │───▶│ 预处理    │───▶│ 目标检测  │             │
│  │ (30 fps) │    │ (去噪/增强│    │ (YOLOv8-s │             │
│  └──────────┘    │  /稳像)   │    │  + P2层)  │             │
│                  └───────────┘    └─────┬─────┘             │
│                                        │                    │
│                            ┌───────────▼───────────┐        │
│                            │  目标未检测到？        │        │
│                            │  是→继续搜索          │        │
│                            │  否→进入跟踪          │        │
│                            └───────────┬───────────┘        │
│                                        │                    │
│                  ┌─────────────────────▼──────────────┐     │
│                  │          目标跟踪                   │     │
│                  │                                    │     │
│                  │  窄视场模式:                        │     │
│                  │    KCF跟踪 + 光流辅助预测           │     │
│                  │    监测目标角速度                    │     │
│                  │                                    │     │
│                  │  if 角速度 > 30°/s (近距):          │     │
│                  │    → 自动切换广角相机               │     │
│                  │    → 广角模式 KCF/YOLO 跟踪        │     │
│                  │                                    │     │
│                  │  if 角速度 < 10°/s (远距/减速):     │     │
│                  │    → 切回窄视场高精度跟踪           │     │
│                  └─────────────────────┬──────────────┘     │
│                                        │                    │
│                  ┌─────────────────────▼──────────────┐     │
│                  │          输出                       │     │
│                  │  目标角度(Az, El)                   │     │
│                  │  目标像素坐标(u, v)                 │     │
│                  │  目标尺寸/类型                      │     │
│                  │  置信度                             │     │
│                  └────────────────────────────────────┘     │
└─────────────────────────────────────────────────────────────┘
```

#### 4.4.1 目标检测 — YOLOv8-s + P2 小目标层

网络结构修改：
- 在 YOLOv8-s 基础上增加 P2 检测层（stride=4），专门检测小目标
- 输入分辨率：640 × 640
- 推理速度：~15 ms/帧 (Jetson Orin AGX, FP16)
- 类别：{多旋翼无人机, 固定翼无人机, 鸟类, 其他飞行物}
- 训练数据增强：小目标复制粘贴（Copy-Paste）、Mosaic、多尺度

#### 4.4.2 像素-角度转换

云台编码器提供当前指向角 \((Az_{gimbal}, El_{gimbal})\)，结合相机
内参完成像素到角度的转换：

**相机内参矩阵**：

\[
\mathbf{K} = \begin{bmatrix} f_x & 0 & u_0 \\ 0 & f_y & v_0 \\ 0 & 0 & 1 \end{bmatrix}
\]

**像素 → 视线角**：

\[
\Delta Az = \arctan\left(\frac{u - u_0}{f_x}\right)
\]

\[
\Delta El = \arctan\left(\frac{v - v_0}{f_y}\right)
\]

**视线角 → 全局角**：

\[
Az = Az_{gimbal} + \Delta Az
\]

\[
El = El_{gimbal} + \Delta El
\]

#### 4.4.3 近距自动切换策略

**切换判据**：

目标角速度估计：

\[
\dot{\theta} = \frac{\sqrt{(\Delta u)^2 + (\Delta v)^2}}{f \cdot \Delta t}
\]

| 条件 | 动作 |
|------|------|
| \(\dot{\theta} > 30°/s\) 且持续 > 0.5s | 切换到广角相机 |
| \(\dot{\theta} < 10°/s\) 且持续 > 1.0s | 切回窄视场相机 |
| 目标丢失 > 0.5s | 切换到广角相机重新捕获 |

**切换过程**：
1. 广角相机始终运行检测算法（低帧率 10 fps 节省算力）
2. 切换时，广角相机提升到 30 fps
3. 利用切换前的目标位置预测，在广角图像中框定搜索区域
4. 广角 YOLO 检测 + KCF 跟踪接力

### 4.5 光电量测输出格式

```
struct EOReport {
    uint32_t  timestamp_ms;     // GPS时间戳 (ms)
    float     azimuth_rad;      // 方位角 (rad)
    float     elevation_rad;    // 俯仰角 (rad)
    float     az_accuracy_rad;  // 方位精度 (rad, 1σ)
    float     el_accuracy_rad;  // 俯仰精度 (rad, 1σ)
    uint16_t  pixel_u;          // 目标像素 x
    uint16_t  pixel_v;          // 目标像素 y
    uint16_t  bbox_w;           // 边界框宽
    uint16_t  bbox_h;           // 边界框高
    float     confidence;       // 检测置信度 [0,1]
    uint8_t   target_class;     // 目标类别
    uint8_t   camera_id;        // 相机ID (0:窄可见 1:窄红外 2:广角)
    uint8_t   track_status;     // 跟踪状态 (0:搜索 1:跟踪 2:丢失)
};
```

---

## 5 声学阵列子系统

### 5.1 系统参数

| 参数 | 指标 | 备注 |
|------|------|------|
| 阵元数 | 32 | MEMS麦克风 |
| 阵列构型 | 均匀圆阵 (UCA) | 直径 0.8 m |
| 频率范围 | 100 Hz ~ 8000 Hz | |
| 采样率 | 48 kHz / 通道 | 24 bit ADC |
| 动态范围 | ≥ 90 dB | |
| 灵敏度 | ≤ -38 dBV/Pa | |
| 探测距离 | ≥ 300 m (安静), ≥ 150 m (城市) | SNR > 6 dB |
| 方位精度 | ≤ 3° (SNR > 10 dB) | |
| 俯仰精度 | ≤ 8° (SNR > 10 dB) | |
| 刷新率 | 10 Hz | 100 ms/帧 |
| 功耗 | ≤ 30 W | |
| 重量 | ≤ 8 kg | |

### 5.2 阵列几何设计

**均匀圆阵 (UCA) 阵元位置**：

32 个阵元均匀分布在半径 R = 0.4 m 的圆上：

\[
(x_n, y_n) = \left(R \cos\frac{2\pi n}{N}, R \sin\frac{2\pi n}{N}\right), \quad n = 0, 1, \ldots, 31
\]

**空间 Nyquist 频率**：

相邻阵元间距：

\[
d = 2R \sin\frac{\pi}{N} = 2 \times 0.4 \times \sin\frac{\pi}{32} \approx 0.078 \text{ m}
\]

避免空间混叠的最高频率：

\[
f_{max} = \frac{c_{sound}}{2d} = \frac{343}{2 \times 0.078} \approx 2200 \text{ Hz}
\]

对于 8000 Hz 的高频信号，使用 MUSIC 超分辨算法避免栅瓣影响。

### 5.3 声学信号处理流程

```
32ch 麦克风采样
    │
    ▼
┌────────────┐
│ 预处理     │
│ · 去直流   │
│ · 带通滤波 │  100 Hz ~ 8 kHz
│ · 自适应   │
│   降噪     │
└─────┬──────┘
      │
      ▼
┌────────────┐     ┌────────────┐
│ 检测       │────▶│ DOA 估计   │
│ · 能量检测 │     │ · MVDR波束 │
│ · 频谱特征 │     │   形成     │
│ · 无人机   │     │ · MUSIC    │
│   噪声匹配 │     │   超分辨   │
└────────────┘     └─────┬──────┘
                         │
                         ▼
                  ┌────────────┐
                  │ 特征提取   │
                  │ · MFCC     │
                  │ · 旋翼谐波 │
                  │ · 信噪比   │
                  └─────┬──────┘
                        │
                        ▼
                  ┌────────────┐
                  │ 分类       │
                  │ · SVM/CNN  │
                  │ 无人机 vs  │
                  │ 鸟类 vs    │
                  │ 噪声       │
                  └─────┬──────┘
                        │
                        ▼
                   输出报告
```

#### 5.3.1 MVDR 波束形成

**导向矢量**（均匀圆阵）：

\[
a_n(\theta, \phi) = \exp\left(j \frac{2\pi R}{\lambda} \left[\cos\left(\frac{2\pi n}{N} - \theta\right) \cos\phi\right]\right)
\]

其中 \(\theta\) 为方位角, \(\phi\) 为俯仰角。

**MVDR 权值计算**：

\[
\mathbf{w}_{MVDR}(\theta, \phi) = \frac{\mathbf{R}_{xx}^{-1} \mathbf{a}(\theta, \phi)}{\mathbf{a}^H(\theta, \phi) \mathbf{R}_{xx}^{-1} \mathbf{a}(\theta, \phi)}
\]

**空间协方差矩阵估计**：

\[
\hat{\mathbf{R}}_{xx} = \frac{1}{L} \sum_{l=1}^{L} \mathbf{x}(l) \mathbf{x}^H(l)
\]

使用 L = 480 个快拍（100 ms × 48 kHz / 10 子帧）。

对角加载提高鲁棒性：

\[
\hat{\mathbf{R}}_{loaded} = \hat{\mathbf{R}}_{xx} + \epsilon \mathbf{I}
\]

\(\epsilon = 0.01 \times \text{tr}(\hat{\mathbf{R}}_{xx}) / N\)

#### 5.3.2 MUSIC DOA 估计

**步骤 1**：对 \(\hat{\mathbf{R}}_{xx}\) 进行特征分解：

\[
\hat{\mathbf{R}}_{xx} = \mathbf{U}_s \mathbf{\Lambda}_s \mathbf{U}_s^H + \mathbf{U}_n \mathbf{\Lambda}_n \mathbf{U}_n^H
\]

信号子空间 \(\mathbf{U}_s\) 和噪声子空间 \(\mathbf{U}_n\) 通过
特征值大小区分（MDL 准则估计信号数）。

**步骤 2**：计算空间谱：

\[
P_{MUSIC}(\theta, \phi) = \frac{1}{\mathbf{a}^H(\theta, \phi) \mathbf{U}_n \mathbf{U}_n^H \mathbf{a}(\theta, \phi)}
\]

**步骤 3**：二维搜索谱峰：
- 方位搜索范围：0° ~ 360°，步进 1°
- 俯仰搜索范围：0° ~ 60°，步进 2°
- 峰值位置即为 DOA 估计

#### 5.3.3 无人机声学特征

**旋翼噪声特征**：

多旋翼无人机的主要噪声源为旋翼，产生以下特征频率：

\[
f_{BPF} = n_{blade} \times \frac{RPM}{60}
\]

| 无人机类型 | 桨叶数 | 典型RPM | BPF (Hz) | 谐波 |
|-----------|--------|---------|----------|------|
| DJI Mini | 2叶 | 7000 | 233 | 466, 699, ... |
| DJI Mavic | 2叶 | 6500 | 217 | 434, 651, ... |
| DJI Phantom | 2叶 | 5400 | 180 | 360, 540, ... |
| 穿越机 | 3叶 | 25000 | 1250 | 2500, 3750, ... |

**MFCC 特征提取**：
- 取 100 ms 音频帧
- 预加重 → 分帧(25ms) → 加窗(Hamming) → FFT
- Mel 滤波器组 (40 个)
- 取对数 → DCT → 前 13 个系数
- 一阶差分 + 二阶差分 → 39 维特征向量

**分类器**：
- 轻量级 1D-CNN 或 SVM
- 三分类：无人机 / 鸟类 / 背景噪声
- 训练数据：各类样本 > 5000 段

### 5.4 声学量测输出格式

```
struct AcousticReport {
    uint32_t  timestamp_ms;     // GPS时间戳 (ms)
    float     azimuth_rad;      // 方位角 (rad)
    float     elevation_rad;    // 俯仰角 (rad)
    float     az_accuracy_rad;  // 方位精度 (rad, 1σ)
    float     el_accuracy_rad;  // 俯仰精度 (rad, 1σ)
    float     snr_dB;           // 信噪比 (dB)
    float     confidence;       // 检测置信度 [0,1]
    uint8_t   target_class;     // 分类结果
    float     feature_vec[13];  // MFCC特征(用于融合分类)
};
```

---

## 6 无线电侦测子系统

### 6.1 系统参数

| 参数 | 指标 | 备注 |
|------|------|------|
| 侦收频段 | 900 MHz / 2.4 GHz / 5.8 GHz | ISM频段 |
| 瞬时带宽 | ≥ 40 MHz (2.4G), ≥ 80 MHz (5.8G) | |
| 灵敏度 | ≤ -90 dBm | |
| 探测距离 | ≥ 1500 m | |
| 测向方式 | 相位干涉仪 (5元) | |
| 测向精度 | ≤ 5° (RMS) | |
| 频谱扫描速率 | ≤ 50 ms/全频段 | |
| 协议识别 | DJI OcuSync / ELRS / DSMX / WiFi | |
| 功耗 | ≤ 50 W | |
| 重量 | ≤ 10 kg | |

### 6.2 信号处理流程

```
天线接收 → LNA → 混频下变频 → ADC → 数字接收
                                          │
                    ┌─────────────────────▼──────────────┐
                    │                                    │
              ┌─────▼─────┐         ┌────────────────┐   │
              │ 频谱监测   │         │ 测向处理       │   │
              │ · 能量检测 │         │ · 相位提取    │   │
              │ · 信号截获 │         │ · 干涉仪     │   │
              │ · 频率估计 │         │   解模糊     │   │
              └─────┬─────┘         │ · DOA估计    │   │
                    │               └───────┬────────┘   │
                    │                       │            │
              ┌─────▼─────┐                │            │
              │ 协议识别   │                │            │
              │ · 特征匹配 │                │            │
              │ · DJI识别  │                │            │
              │ · ELRS识别 │                │            │
              │ · WiFi识别 │                │            │
              └─────┬─────┘                │            │
                    │                       │            │
                    └───────────┬───────────┘            │
                                │                        │
                          ┌─────▼─────┐                  │
                          │ 输出报告   │                  │
                          └───────────┘                  │
                    └────────────────────────────────────┘
```

### 6.3 相位干涉仪测向

**5 元线阵配置**：

基线长度比例 1:2:4:8，满足测向精度和无模糊需求。

**相位差 → 方位角**：

\[
\theta = \arcsin\left(\frac{\Delta\phi \cdot \lambda}{2\pi \cdot d}\right)
\]

其中 \(\Delta\phi\) 为两天线间相位差，\(d\) 为基线长度。

多基线解模糊流程：
1. 短基线粗测（无模糊，精度低）
2. 中基线精化
3. 长基线高精度（可能模糊，用短基线解模糊）

### 6.4 协议识别

| 协议 | 特征 | 识别方法 |
|------|------|---------|
| DJI OcuSync | 2.4G/5.8G 跳频，特定帧结构 | 跳频图案匹配 |
| DJI Lightbridge | 2.4G OFDM，20MHz带宽 | 带宽+调制识别 |
| ELRS | 2.4G/900M LoRa调制 | Chirp特征匹配 |
| DSMX | 2.4G DSSS跳频 | 跳频速率+码片特征 |
| WiFi(FPV) | 2.4G/5.8G 802.11 | 标准WiFi帧解码 |

### 6.5 RF量测输出格式

```
struct RFReport {
    uint32_t  timestamp_ms;     // GPS时间戳 (ms)
    float     azimuth_rad;      // 方位角 (rad)
    float     az_accuracy_rad;  // 方位精度 (rad, 1σ)
    float     frequency_MHz;    // 中心频率 (MHz)
    float     bandwidth_MHz;    // 信号带宽 (MHz)
    float     rssi_dBm;         // 信号强度 (dBm)
    uint8_t   protocol_id;      // 协议类型ID
    uint8_t   confidence;       // 识别置信度 [0,100]
    uint8_t   is_controller;    // 是否为遥控器信号 (0/1)
};
```

---

## 7 传感器时间同步

### 7.1 授时方案

所有传感器及融合处理平台统一采用 **GPS/北斗** 授时：

```
GPS/北斗卫星
    │
    ▼
┌──────────────┐
│ GPS接收机    │  1PPS + NMEA
│ (共用)       │
└──────┬───────┘
       │ 1PPS脉冲 + UTC时间
       │
  ┌────┼────┬────────┬───────────┐
  │    │    │        │           │
  ▼    ▼    ▼        ▼           ▼
雷达  光电  声学    RF侦测    融合平台
```

### 7.2 同步精度

| 环节 | 精度 |
|------|------|
| GPS 1PPS | ≤ 100 ns |
| 内部时钟锁定 | ≤ 10 μs |
| 以太网传输延迟补偿 | ≤ 100 μs |
| **综合时间同步精度** | **≤ 0.5 ms** |

满足 200 ms 融合周期的时间对齐需求（0.5 ms << 200 ms）。

---

## 8 传感器安装与标定

### 8.1 安装位置关系

所有传感器相对平台中心的安装偏移量需精确测量并录入系统：

\[
\Delta\mathbf{p}_s = [dx_s, dy_s, dz_s]^T
\]

### 8.2 轴线标定

各传感器轴线与平台坐标系的角度偏差需通过标定消除：

| 标定项 | 方法 | 精度要求 |
|--------|------|---------|
| 雷达指北偏差 | 已知目标定标 | ≤ 0.5° |
| 光电云台零位 | 星标/已知目标 | ≤ 0.1° |
| 声学阵列指向 | 已知声源定标 | ≤ 1° |
| RF天线指向 | 已知信号源定标 | ≤ 2° |

---

*文档结束*
