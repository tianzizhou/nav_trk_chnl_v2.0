# 双目摄像头无人机检测仿真系统 — 系统总体方案文档

## 1. 概述与目标

### 1.1 项目背景

随着无人机技术的快速发展，无人机之间的对抗场景日益增多。在高速空中对抗环境中，
己方无人机需要快速、准确地检测、识别和定位敌方无人机目标，为后续的规避、拦截或
协同作战提供实时态势感知信息。

### 1.2 项目目标

设计一套装载于无人机平台的**双目立体摄像头图像处理仿真系统**，实现：

1. **实时检测**：对每秒 120 帧 Full HD（1920×1080）双目图像进行实时处理
2. **高速目标跟踪**：识别和跟踪相对运动速度超过 1000 km/h 的无人机目标
3. **三维定位**：给出目标无人机相对于己方的方位角、俯仰角、距离和速度
4. **碰撞预警**：计算碰撞预警时间（TTC），提供威胁评估

### 1.3 仿真目标

在无法获取真实硬件和飞行数据的条件下，通过软件仿真验证整个处理流水线的
算法正确性和系统可行性，为后续的硬件部署提供算法基线。

---

## 2. 需求分析

### 2.1 功能需求

| 编号 | 需求描述 | 优先级 |
|------|----------|--------|
| FR-01 | 双目立体图像采集与预处理（畸变校正、立体校正） | 高 |
| FR-02 | 无人机目标检测（支持远距离小目标） | 高 |
| FR-03 | 立体匹配与深度估计 | 高 |
| FR-04 | 多目标跟踪与数据关联 | 高 |
| FR-05 | 三维位置解算（方位角/俯仰角/斜距） | 高 |
| FR-06 | 相对速度估计与碰撞预警 | 高 |
| FR-07 | 合成场景生成（8类典型场景） | 高 |
| FR-08 | 性能评估与仿真报告生成 | 中 |
| FR-09 | 蒙特卡洛统计验证 | 中 |

### 2.2 性能需求

| 指标 | 目标值 | 说明 |
|------|--------|------|
| 处理帧率 | 120 fps | 单帧预算 ≤ 8.33 ms |
| 图像分辨率 | 1920×1080 | Full HD 双目 |
| 相对速度范围 | 0 ~ 1200+ km/h | 含迎头、交叉、尾追 |
| 检测距离范围 | 50 m ~ 2000 m | 远距离为小目标 |
| 检测率 (Pd) | > 95% | 在有效检测距离内 |
| 虚警率 (Pfa) | < 1% | 每帧虚假检测概率 |
| 3D 位置 RMSE | < 5% (距离比例) | 与真实距离的比例误差 |
| 方位角误差 | < 0.5° | 在 50m 以上距离 |
| 跟踪连续性 MOTA | > 90% | 多目标跟踪精度 |

### 2.3 环境约束

| 约束 | 详情 |
|------|------|
| 机载功耗限制 | 总处理功耗 < 50W |
| 尺寸重量限制 | 处理板卡适配无人机载荷 |
| 环境条件 | 高空、强光/背光、振动 |
| 仿真环境 | 纯 CPU Python 环境（无 GPU） |

---

## 3. 候选处理平台方案对比

### 3.1 方案A：NVIDIA Jetson AGX Orin

- **算力**：275 TOPS (INT8)
- **GPU**：2048 CUDA Cores + 64 Tensor Cores (Ampere)
- **功耗**：15-60W（可配置）
- **优势**：生态成熟，CUDA/TensorRT 支持完善，开发效率高
- **劣势**：YOLOv8n INT8 推理约 65 fps，单独难以达到 120 fps
- **120fps 可行性**：⚠️ 需要极致优化或降低分辨率

### 3.2 方案B：NVIDIA Jetson AGX Thor

- **算力**：800 TOPS (INT8)
- **GPU**：下一代 GPU 架构
- **功耗**：~100W
- **优势**：算力充足，有望单芯片实现 120 fps 推理
- **劣势**：功耗偏高（100W），尚未量产，供货风险
- **120fps 可行性**：✅ 理论可行

### 3.3 方案C：Xilinx Zynq UltraScale+ FPGA

- **算力**：可定制硬件流水线
- **功耗**：5-25W
- **优势**：低功耗、确定性延迟、可实现固定流水线
- **劣势**：开发周期长、灵活性差、AI 推理效率不如 GPU
- **120fps 可行性**：✅ 对于预处理和 SGBM 等固定算法

### 3.4 方案D：FPGA + GPU 异构架构（推荐）

- **组成**：Zynq UltraScale+（预处理/SGBM）+ Jetson Orin（AI检测/跟踪）
- **功耗**：30-60W
- **优势**：各取所长，FPGA 负责确定性低延迟任务，GPU 负责灵活 AI 推理
- **劣势**：系统复杂度高，需要高速互联（PCIe/AXI）
- **120fps 可行性**：✅ 流水线并行实现

### 3.5 方案对比矩阵

| 维度 | Jetson Orin | Jetson Thor | Zynq FPGA | FPGA+GPU |
|------|:-----------:|:-----------:|:---------:|:--------:|
| 120fps 可行性 | ⚠️ | ✅ | ✅(部分) | ✅ |
| 功耗 (W) | 15-60 | ~100 | 5-25 | 30-60 |
| 开发效率 | ★★★★★ | ★★★★ | ★★ | ★★★ |
| 供货成熟度 | ★★★★★ | ★★ | ★★★★ | ★★★★ |
| AI 推理灵活性 | ★★★★★ | ★★★★★ | ★★ | ★★★★ |
| 确定性延迟 | ★★★ | ★★★ | ★★★★★ | ★★★★ |
| 综合评分 | 3.8 | 3.5 | 3.2 | **4.2** |

---

## 4. 推荐方案及理由

### 4.1 推荐方案：FPGA + GPU 异构架构

**推荐理由**：

1. **满足帧率要求**：FPGA 硬件流水线处理图像采集、ISP、立体校正和 SGBM
   视差计算，延迟 < 3.5ms；GPU 处理 AI 检测和跟踪，延迟 < 4ms；
   流水线并行总延迟 < 8ms。

2. **功耗可控**：30-60W 在无人机载荷的可接受范围内。

3. **各取所长**：FPGA 提供确定性低延迟的固定算法处理；GPU 提供灵活的
   神经网络推理能力，便于后续算法迭代升级。

4. **供货可靠**：Zynq UltraScale+ 和 Jetson Orin 均为成熟产品，供货稳定。

### 4.2 流水线延迟预算分配

| 模块 | 执行平台 | 预算延迟 | 说明 |
|------|----------|----------|------|
| 图像采集 + ISP | FPGA | < 1.0 ms | 传感器接口 + 去噪 |
| 立体校正 + 畸变校正 | FPGA | < 0.5 ms | 查表法实现 |
| SGBM 视差计算 | FPGA | < 2.0 ms | ROI 区域 |
| 数据传输 (FPGA→GPU) | PCIe/AXI | < 0.3 ms | 校正图 + 视差图 |
| YOLOv8n 推理 | GPU (TensorRT) | < 3.0 ms | INT8 量化 |
| 三角测量 + 3D 定位 | GPU | < 0.5 ms | CUDA 核函数 |
| EKF 跟踪 + 预测 | GPU/CPU | < 1.0 ms | 多目标管理 |
| **总计** | — | **< 8.3 ms** | **满足 120 fps** |

---

## 5. 关键指标与约束

### 5.1 系统级指标

| 指标类别 | 指标名称 | 目标值 | 验证方法 |
|----------|----------|--------|----------|
| 实时性 | 帧处理延迟 | ≤ 8.33 ms | 仿真计时 |
| 检测性能 | 检测率 Pd | > 95% | 场景仿真统计 |
| 检测性能 | 虚警率 Pfa | < 1% | 场景仿真统计 |
| 定位精度 | 3D RMSE | < 5% 距离 | 与 GT 对比 |
| 定位精度 | 方位角误差 | < 0.5° | 与 GT 对比 |
| 跟踪性能 | MOTA | > 90% | MOT 指标 |
| 预警能力 | TTC 误差 | < 100 ms | 与理论值对比 |

### 5.2 仿真约束

- 仿真环境为纯 CPU Python，检测模块使用模拟检测器
- 合成图像为简化渲染（几何体投影），非真实感渲染
- 仿真重点验证算法流水线正确性，不验证硬件时序

---

## 6. 风险评估

| 编号 | 风险描述 | 概率 | 影响 | 缓解措施 |
|------|----------|------|------|----------|
| R-01 | 无 GPU 环境无法运行真实检测网络 | 确定 | 高 | 使用模拟检测器，接口预留 |
| R-02 | 远距离视差 < 1 像素，深度估计失效 | 高 | 高 | 融合尺寸先验估计 |
| R-03 | 1000+ km/h 帧间位移过大致跟踪丢失 | 中 | 高 | EKF 预测驱动搜索 + 放大窗口 |
| R-04 | 文档工作量大，影响交付进度 | 中 | 中 | 模板化 + 代码/文档并行 |
| R-05 | 合成图像过于理想，仿真结果偏乐观 | 中 | 中 | 添加噪声/模糊/遮挡干扰 |
| R-06 | SGBM 参数对场景敏感 | 中 | 低 | 参数灵敏度分析 |

---

## 7. 参考资料

1. Hirschmuller, H. "Stereo Processing by Semi-Global Matching and Mutual
   Information." IEEE TPAMI, 2008.
2. Ultralytics YOLOv8 Documentation. https://docs.ultralytics.com/
3. Bewley, A. et al. "Simple Online and Realtime Tracking." IEEE ICIP, 2016.
4. Bar-Shalom, Y. et al. "Estimation with Applications to Tracking and
   Navigation." Wiley, 2001.
5. Bradski, G. "The OpenCV Library." Dr. Dobb's Journal, 2000.
6. NVIDIA Jetson AGX Orin Technical Reference Manual.
7. Xilinx Zynq UltraScale+ MPSoC Data Sheet (DS891).
