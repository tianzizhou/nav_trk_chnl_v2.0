# ==============================================================================
# Stereo Vision UAV Detection Simulation System - Default Configuration
# Copyright (c) 2023-2026 Shanghai Wuben Technology Co., Ltd.
# ==============================================================================

# --- Camera Parameters ---
camera:
  # Image resolution
  image_width: 1920
  image_height: 1080

  # Left camera intrinsic parameters
  left:
    fx: 1200.0          # Focal length x (pixels)
    fy: 1200.0          # Focal length y (pixels)
    cx: 960.0           # Principal point x (pixels)
    cy: 540.0           # Principal point y (pixels)
    # Distortion coefficients [k1, k2, p1, p2, k3]
    distortion: [-0.1, 0.01, 0.0, 0.0, 0.0]

  # Right camera intrinsic parameters
  right:
    fx: 1200.0
    fy: 1200.0
    cx: 960.0
    cy: 540.0
    distortion: [-0.1, 0.01, 0.0, 0.0, 0.0]

  # Stereo extrinsic parameters
  stereo:
    baseline: 0.3       # Baseline distance (meters)
    # Rotation from left to right camera (Rodrigues vector, radians)
    rotation: [0.0, 0.0, 0.0]
    # Translation from left to right camera (meters) [tx, ty, tz]
    translation: [0.3, 0.0, 0.0]

  # Camera-to-body frame transformation
  cam_to_body:
    # Rotation (Euler angles ZYX: yaw, pitch, roll in radians)
    rotation: [0.0, 0.0, 0.0]
    # Translation offset (meters)
    translation: [0.1, 0.0, -0.05]

# --- Detection Parameters ---
detection:
  # Simulated detector parameters
  simulated:
    # Bounding box noise standard deviation (pixels) at 100m range
    bbox_noise_std_base: 2.0
    # Detection probability at 100m range
    detection_prob_base: 0.98
    # Detection probability distance decay rate (Sigmoid parameter)
    detection_prob_decay_range: 1500.0
    # False alarm rate (per frame)
    false_alarm_rate: 0.005
    # Minimum confidence threshold
    confidence_threshold: 0.3

  # Full-frame detection frequency (every N frames)
  full_detect_interval: 4

  # Known target drone physical size (meters)
  target_size:
    wingspan: 1.2       # Wingspan
    height: 0.4         # Height
    length: 1.0         # Body length

# --- Stereo Matching Parameters ---
stereo_matching:
  # SGBM parameters
  sgbm:
    min_disparity: 0
    num_disparities: 256    # Must be divisible by 16
    block_size: 5
    p1: 200                 # Penalty for disparity change of 1
    p2: 800                 # Penalty for disparity change > 1
    disp12_max_diff: 1
    uniqueness_ratio: 10
    speckle_window_size: 100
    speckle_range: 2

  # Depth estimation method: "disparity", "size_prior", "fusion"
  depth_method: "fusion"

  # Fusion weight transition range (meters)
  # Below near_range: pure disparity; above far_range: pure size_prior
  fusion_near_range: 100.0
  fusion_far_range: 500.0

# --- Tracking Parameters ---
tracking:
  # EKF parameters
  ekf:
    # Process noise standard deviation for acceleration (m/s^2)
    process_noise_accel_std: 50.0
    # Initial position uncertainty (meters)
    initial_position_std: 10.0
    # Initial velocity uncertainty (m/s)
    initial_velocity_std: 50.0
    # Initial acceleration uncertainty (m/s^2)
    initial_accel_std: 20.0

  # Multi-target tracker parameters
  multi_target:
    # Association gate threshold (meters)
    association_gate: 50.0
    # Cost matrix weights
    cost_weight_3d_distance: 0.7
    cost_weight_iou: 0.3
    # Track management
    tentative_to_confirmed_hits: 3   # Hits needed to confirm
    confirmed_to_lost_misses: 5      # Misses before lost
    lost_to_deleted_misses: 10       # Misses before deletion
    # Maximum number of tracked targets
    max_tracks: 20

# --- Position Solver Parameters ---
position_solver:
  # Coordinate system: "NED" (North-East-Down)
  coordinate_system: "NED"
  # TTC warning threshold (seconds)
  ttc_warning_threshold: 5.0
  # TTC critical threshold (seconds)
  ttc_critical_threshold: 2.0

# --- Simulation Parameters ---
simulation:
  # Frame rate (Hz)
  frame_rate: 120
  # Default simulation duration (seconds)
  default_duration: 10.0
  # Random seed for reproducibility
  random_seed: 42
  # Monte Carlo runs for batch evaluation
  monte_carlo_runs: 100

  # Image synthesis parameters
  image_synthesis:
    # Sky background color (BGR)
    sky_color: [230, 200, 180]
    # Target drone color (BGR)
    target_color: [40, 40, 40]
    # Gaussian noise standard deviation
    noise_std: 5.0
    # Enable motion blur simulation
    enable_motion_blur: true
    # Motion blur kernel size (pixels)
    motion_blur_length: 10

# --- Output Parameters ---
output:
  # Results output directory
  results_dir: "results"
  # Enable per-frame result logging
  log_per_frame: true
  # Enable visualization
  enable_visualization: false
  # Save visualization images
  save_images: false
